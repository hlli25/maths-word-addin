<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!-- This file shows how to design a first-run page that provides a welcome screen to the user about the features of the add-in. -->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Maths Equation Editor</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/>

    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />

    <!-- MathLive for the WYSIWYG editor -->
    <script src="https://unpkg.com/mathlive/dist/mathlive.min.js"></script>

    <!-- MathJax configuration and loading -->
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'local',  // This embeds fonts in the SVG
                scale: 1,
                minScale: 0.5,
                matchFontHeight: false,
                displayAlign: 'center',
                displayIndent: '0',
                mtextInheritFont: false,
                merrorInheritFont: false,
                unknownFamily: 'serif'
            },
            startup: {
                ready: () => {
                    // Override the default ready function to ensure proper initialization
                    MathJax.startup.defaultReady();
                    MathJax.startup.document.updateDocument();
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>

<body class="ms-font-m ms-welcome ms-Fabric">
    <div id="app-container">
        <h1 class="ms-fontSize-xl ms-fontWeight-bold">WYSIWYG Maths Editor</h1>
        <p class="ms-fontSize-m ms-fontWeight-regular">Create your equation below. It will be inserted as a high-quality image.</p>
        
        <!-- The MathLive editor element -->
        <math-field id="math-editor"></math-field>

        <!-- Container for the action button and status messages -->
        <div class="footer">
             <button id="insert-equation-button" class="ms-Button ms-Button--primary" disabled>
                <span class="ms-Button-label">Insert Equation</span>
             </button>
             <div id="status"></div>
        </div>
        
        <!-- Hidden container for MathJax rendering. This is not displayed to the user. -->
        <div id="mathjax-renderer"></div>
    </div>
    
</body>

</html>