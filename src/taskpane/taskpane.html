<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Equation Editor</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/>

    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />

    <!-- MathJax configuration and loading -->
    <script>
        window.MathJax = {
            tex: {
                packages: {'[+]': ['textmacros']},
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            },
            svg: {
                fontCache: 'local',
                scale: 1,
                minScale: 0.5,
                matchFontHeight: true, // Enable baseline calculation for proper alignment
                displayIndent: '0',
                mtextInheritFont: true, // Allow text elements to inherit the surrounding font
                unknownFamily: 'serif'
            },
            startup: {
                ready: () => {
                    MathJax.startup.defaultReady();
                    MathJax.startup.document.updateDocument();
                }
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>

<body class="ms-font-m">
    <div id="app-container">
        <h1 class="ms-fontSize-xl ms-fontWeight-bold">Equation Editor</h1>
        <p class="ms-fontSize-m ms-fontWeight-regular">Build your equation using the visual editor below.</p>
        
        <!-- Equation Builder Display -->
        <div class="equation-display equation-container" id="equationDisplay">
            <span class="empty-state">Click here and start typing your equation</span>
        </div>
        <input type="text" class="equation-input" id="hiddenInput" />


        <!-- Font Size Control -->
        <div class="font-controls">
            <label for="fontSizeInput" class="font-label">Font Size:</label>
            <input type="number" id="fontSizeInput" class="font-size-input" value="12" min="6" max="72" step="1" />
            <span class="font-unit">pt</span>
        </div>

        <!-- Button Panel with Tabs -->
        <div class="tab-panel">
            <div class="tab-nav">
                <button class="tab-btn active" data-tab="structures">Structures</button>
                <button class="tab-btn" data-tab="brackets">Brackets</button>
                <button class="tab-btn" data-tab="operations">Operations</button>
            </div>
            <div class="tab-content">
                <div id="structures" class="tab-pane active">
                    <div class="button-row">
                        <button class="builder-btn fraction-btn" title="Fraction">
                            <div class="fraction-icon">
                                <div class="fraction-numerator">□</div>
                                <div class="fraction-line"></div>
                                <div class="fraction-denominator">□</div>
                            </div>
                        </button>
                        <button class="builder-btn bevelled-fraction-btn" title="Bevelled Fraction">
                            <div class="bevelled-fraction-icon">□/□</div>
                        </button>
                        <button class="builder-btn sqrt-btn" title="Square Root">√□</button>
                        <button class="builder-btn nthroot-btn" title="Root">
                            <div class="nthroot-icon">
                                <span class="root-index">□</span>√<span class="root-radicand">□</span>
                            </div>
                        </button>
                    </div>
                    <div class="button-row">
                        <button class="builder-btn sup-btn" title="Superscript">□<sup>□</sup></button>
                        <button class="builder-btn sub-btn" title="Subscript">□<sub>□</sub></button>
                        <button class="builder-btn sup-sub-btn" title="Superscript-Subscript">
                            <div class="sup-sub-icon">
                                <div class="sup-sub-base">□</div>
                                <div class="sup-sub-scripts">
                                    <div class="sup-sub-super">□</div>
                                    <div class="sup-sub-sub">□</div>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>
                <div id="brackets" class="tab-pane">
                    <div class="bracket-builder">
                        <div class="bracket-component">
                            <select id="leftBracketSelect" class="bracket-select">
                                <option value=""></option>
                                <option value="(" selected>(</option>
                                <option value="[">[</option>
                                <option value="{">{</option>
                                <option value="⌊">⌊</option>
                                <option value="⌈">⌈</option>
                                <option value="|">|</option>
                                <option value="‖">‖</option>
                            </select>
                        </div>
                        
                        <div class="bracket-component bracket-input">
                            <div class="bracket-input-display">□</div>
                        </div>
                        
                        <div class="bracket-component">
                            <select id="rightBracketSelect" class="bracket-select">
                                <option value=""></option>
                                <option value=")" selected>)</option>
                                <option value="]">]</option>
                                <option value="}">}</option>
                                <option value="⌋">⌋</option>
                                <option value="⌉">⌉</option>
                                <option value="|">|</option>
                                <option value="‖">‖</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="bracket-actions">
                        <button id="insertCustomBracket" class="builder-btn custom-bracket-btn">Insert Bracket(s)</button>
                    </div>
                </div>
                <div id="operations" class="tab-pane">
                    <button class="builder-btn operator-btn" data-operator="×">×</button>
                    <button class="builder-btn operator-btn" data-operator="÷">÷</button>
                </div>
            </div>
        </div>

        <!-- Container for the action buttons and status messages -->
        <div class="footer">
            <div class="footer-controls">
                <button id="clear-equation-button" class="ms-Button ms-Button--secondary">
                    <span class="ms-Button-label">Clear</span>
                </button>
                <button id="insert-equation-button" class="ms-Button ms-Button--primary">
                    <span class="ms-Button-label">Insert Equation</span>
                </button>
            </div>
            <div id="status"></div>
        </div>
        
        <!-- Hidden container for MathJax rendering -->
        <div id="mathjax-renderer"></div>
    </div>
</body>

</html>